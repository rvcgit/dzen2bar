#!/usr/bin/env sh
X="$(xrandr | grep '*' | uniq | awk '{print$1}' | cut -d 'x' -f1)"  # your horizontal screen resolution
Y="$(xrandr | grep '*' | uniq | awk '{print$1}' | cut -d 'x' -f2)"  # your vertical screen resolution
XP="$(xdotool getmouselocation | awk '{print$1}' | sed 's/x://g')" #mouse coordinate X
YP="$(xdotool getmouselocation | awk '{print$2}' | sed 's/y://g')" #mouse coordinate Y

bar_length=90 # % length w.r.t X width; edit to suit your need
wc=$(($X*$bar_length/100)) # bar length; % width as per panel_length
xc=$(($X*2/1000)) # 7.5% offset of X resolution

# BOTTOM BAR
 y=$(($Y*997/1000)) # y offset from y resolution; current is 99% of Y resolution

# TOP BAR ; comment out above line and uncomment below line for TOP BAR
# y=$(($Y*3/1000))  # y offser from y resolution; current is 0.3% of Y resolution;

## right for systray ; add your tray app [stalonetray OR trayer; below is trayer command]
# alignment is always to right by default; change to left if you need
w_mgr="$(wmctrl -m | grep Name:| awk '{print $NF}')"
if [ "$w_mgr" != "XMonad"] || [ "$wm" != "dwm" ];then # non EWMH compliant
	if [ $w_mgr = "i3" ] || [ $w_mgr = "herbstluftwm" ];then 
		dock="true"
		else
		dock="false"
	fi
	if [ $y -lt 40 ]; then
		edge="top"
		else
		edge="bottom"
	fi
alfa="0" #set your trayer bg alpha value [ 0 is opaque; to 255 full transparent ]
trayer --edge $edge --align right --distancefrom right \
--distance 10 --widthtype request --heighttype pixel --height 18 \
--transparent true --alpha $alfa --tint 0x111827 \
--SetDockType $dock \
--padding 2 --margin 1 --iconspacing 4 --expand false
fi &

conky -c ~/.conky/dzenpanelConky | dzen2 -p -e 'enterslave=grabkeys;leaveslave=ungrabkeys; button4=scrollup;button5=scrolldown; key_Left=scrollup;key_Right=scrolldown; button1=menuexec' -h '18' -w $wc -ta r -x $xc -y $y -fn 'Inconsolata Nerd Font:pixelsize=11:antialias=true' &

## deps for workspace and forecast
location="MY_CITY_NAME" ## TYPE YOUR CITY NAME WITHIN QUOTES
sleep 5 && sh ~/.bin/dzenworkspaces.sh &
sleep 15 && if [ "$(wmctrl -d | sed -n '/* /s///p' | awk '{print$NF}')" = " " ];then echo " " > /tmp/AWS;fi &
while : ;do curl -s 'http://v1.wttr.in/$location\?MT' | tail -n33 | head -n30 > /tmp/asciiwttr;sleep 1801;done
